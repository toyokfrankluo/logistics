{% extends "base.html" %}
{% block content %}
<div class="container mt-4">
    <h2>代理管理</h2>

    <!-- 添加代理表单 -->
    <form method="POST" action="{{ url_for('views.agents') }}" class="mb-4">
        <div class="form-group mb-2">
            <label for="name">代理名称</label>
            <input type="text" class="form-control" id="name" name="name" required>
        </div>

        <div class="form-group mb-2">
            <label for="api_url">API 地址</label>
            <input type="text" class="form-control" id="api_url" name="api_url">
        </div>

        <div class="form-group mb-2">
            <label for="app_key">App Key</label>
            <input type="text" class="form-control" id="app_key" name="app_key">
        </div>

        <div class="form-group mb-2">
            <label for="app_token">App Token</label>
            <input type="text" class="form-control" id="app_token" name="app_token">
        </div>

        <div class="form-group mb-2">
            <label for="customer_code">客户代码</label>
            <input type="text" class="form-control" id="customer_code" name="customer_code">
        </div>

        <button type="submit" class="btn btn-primary">添加代理</button>
    </form>

    <!-- 代理列表 -->
    <h3>已有代理</h3>
    <table class="table table-bordered">
        <thead>
            <tr>
                <th>ID</th>
                <th>代理名称</th>
                <th>API 地址</th>
                <th>App Key</th>
                <th>App Token</th>
                <th>客户代码</th>
                <th>操作</th>
            </tr>
        </thead>
        <tbody>
            {% for agent in agents %}
            <tr>
                <td>{{ agent.id }}</td>
                <td>{{ agent.name }}</td>
                <td>{{ agent.api_url }}</td>
                <td>{{ agent.app_key }}</td>
                <td>{{ agent.app_token }}</td>
                <td>{{ agent.customer_code }}</td>
                <td>
                    <a href="{{ url_for('views.edit_agent', agent_id=agent.id) }}" class="btn btn-sm btn-warning">编辑</a>
                    <form method="POST" action="{{ url_for('views.delete_agent', agent_id=agent.id) }}" style="display:inline;">
                        <button type="submit" class="btn btn-sm btn-danger" onclick="return confirm('确定要删除这个代理吗？');">删除</button>
                    </form>
                </td>
            </tr>
            {% else %}
            <tr>
                <td colspan="7" class="text-center">暂无代理</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}